---
title: "Storing secrets with the .Renviron file"
author: "Nicolas Casajus"
date: "2024-03-12"
categories: [r, secret, .renviron, security]
image: "logo-r.png"
toc: true
---


## Introduction

What is a secret? It is usually a password, an username or an API token (key) required by services. For instance, some {{< fa brands r-project >}} packages require an authentication method:

- [`usethis`](https://usethis.r-lib.org/) requires a token to control the [GitHub API](https://docs.github.com/en/rest)
- [`taxize`](https://docs.ropensci.org/taxize/) requires tokens to query API provided by several taxonomic databases
- [`rwosstarter`](https://frbcesab.github.io/rwosstarter/) requires a token to access the [Web of Science API](https://developer.clarivate.com/apis/wos-starter)
- [`rgbif`](https://docs.ropensci.org/rgbif/) requires an username and a password associated by a [GBIF](https://www.gbif.org/) account

It's tempting to record secrets as variables in R scripts. But keep this in mind:<br>
**Never share your secrets with anyone** (this also includes GitHub).

According to the [documentation of the `httr`](https://httr.r-lib.org/articles/secrets.html) package, there is three secure ways to store your secrets:

- Ask for the secret each time (no permanent storage).
- Store the secret as an environment variable.
- Use the [`keyring`](https://keyring.r-lib.org/) package and the operating systemâ€™s credential store.

Here we will see how to easily **store secret as an environment variable**.


::: {.callout-tip}
## Environment variable

According to [Wikipedia](https://en.wikipedia.org/wiki/Environment_variable),

> An _environment variable_ is a user-definable value that can affect the way running processes will behave on a computer.

In short, it is a way to pass information to a program. Environment variable are used by many programs and operating systems and are made up of a **name-value pair**.
:::


## The .Renviron file

The [{{< fa brands r-project >}} startup process](https://rstats.wtf/r-startup.html) is complex. But one special {{< fa brands r-project >}} file is interesting for our purpose: the `.Renviron` file. This file does not contain {{< fa brands r-project >}} code: it only contains environment variables that will be pass to {{< fa brands r-project >}} at the startup.

The `.Renviron` file looks like:

```
NAME1=value1
NAME2=value2
```

To open (and create this `~/.Renviron`), run this command:

```{r}
#| eval: false

## Create (if required) and open ~/.Renviron file ----
utils::file.edit("~/.Renviron")
```

This command has created an user `.Renviron` file in his/her `HOME` directory.

A `.Renviron` file can be created at three different levels:

- at the system level (named `.Renviron.site`)
- at the user level (`~/.Renviron`)
- at the project level (`.Renviron`)

